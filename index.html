<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Dla Ciebie ❤️</title>
    <style>
        body { margin: 0; overflow: hidden; background: black; font-family: 'Courier New', monospace; display: flex; justify-content: center; align-items: center; height: 100vh; color: white; -webkit-tap-highlight-color: transparent; }
        canvas { position: fixed; top: 0; left: 0; z-index: -1; }
        
        #startScreen { position: fixed; inset: 0; background: black; z-index: 100; display: flex; justify-content: center; align-items: center; }
        #startBtn { padding: 18px 35px; font-size: 20px; background: #ff4da6; color: white; border: none; border-radius: 15px; cursor: pointer; font-weight: bold; }

        .text-typing { position: absolute; width: 90%; text-align: center; font-size: 22px; color: #ff4da6; top: 40%; }
        
        #questionSection, #successSection { text-align: center; z-index: 10; width: 90%; max-width: 400px; display: none; }
        
        h1 { font-size: 19px; margin: 10px 0; }
        .big-love { font-size: 24px; color: #ff4da6; font-weight: bold; animation: pulse 1s infinite; margin-top: 10px; }
        
        #btnWrapper { position: relative; height: 150px; margin-top: 20px; width: 100%; }

        button { padding: 12px 25px; font-size: 18px; border: none; border-radius: 12px; cursor: pointer; font-weight: bold; }
        #yesBtn { background: #ff4da6; color: white; position: relative; z-index: 20; }
        
        /* Przycisk NIE z poprawionym pozycjonowaniem */
        #noBtn { 
            background: #444; 
            color: white; 
            position: absolute; 
            left: 50%; 
            top: 0;
            transform: translateX(20px); 
            transition: all 0.2s ease;
            white-space: nowrap;
            z-index: 15;
        }

        @keyframes pulse { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.05); } }
        .heart { position: absolute; font-size: 25px; pointer-events: none; z-index: 999; animation: floatUp 3s linear forwards; }
        @keyframes floatUp { 0% { transform: translateY(0); opacity: 1; } 100% { transform: translateY(-100vh); opacity: 0; } }
        
        img { 
            max-width: 60%; 
            max-height: 180px; 
            width: auto;
            height: auto;
            border-radius: 12px; 
            border: 2px solid #ff4da6; 
        }
    </style>
</head>
<body>

<div id="startScreen">
    <button id="startBtn" onclick="startEverything()">KLIKNIJ TUTAJ SKARBIE ❤️</button>
</div>

<canvas id="starfield"></canvas>
<div id="typingArea" class="text-typing"></div>

<div id="questionSection">
    <img src="IMG_3395.JPEG" alt="Zdjęcie 1">
    <h1>Czy będziesz moją walentynką? ❤️</h1>
    <div id="btnWrapper">
        <button id="yesBtn" onclick="acceptValentine()">TAK ❤️</button>
        <button id="noBtn" onmouseover="moveNo()" onclick="moveNo()">NIE :(</button>
    </div>
</div>

<div id="successSection">
    <img src="IMG_3396.JPEG" alt="Zdjęcie 2">
    <div class="big-love">KOCHAM CIE MYSZKAAAA ❤️</div>
</div>

<audio id="music" src="music.mp3" loop preload="auto"></audio>

<script>
    const music = document.getElementById("music");
    const typingArea = document.getElementById("typingArea");
    const questionSection = document.getElementById("questionSection");
    const successSection = document.getElementById("successSection");
    const noBtn = document.getElementById("noBtn");

    function startEverything() {
        document.getElementById("startScreen").style.display = "none";
        music.play();
        runTypewriter();
    }

    /* GWIAZDY */
    const canvas = document.getElementById("starfield");
    const ctx = canvas.getContext("2d");
    let zoom = 1, stars = [];
    function initStars() {
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        stars = [];
        for(let i=0; i<200; i++) stars.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height, r: Math.random()*1.2, o: Math.random()});
    }
    function drawStars() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.save(); ctx.translate(canvas.width/2, canvas.height/2); ctx.scale(zoom,zoom); ctx.translate(-canvas.width/2, -canvas.height/2);
        stars.forEach(s => { ctx.beginPath(); ctx.arc(s.x,s.y,s.r,0,Math.PI*2); ctx.fillStyle=`rgba(255,255,255,${s.o})`; ctx.fill(); });
        ctx.restore(); zoom += 0.0004; requestAnimationFrame(drawStars);
    }
    initStars(); drawStars();

    /* MASZYNA DO PISANIA */
    const lines = ["Julus jestes moim najwiekszym skarbem", "nie wyobrazam sobie byc z kims innym", "jestes moim sloneczkiem, gwiazda", "i wszystkim co istnieje", "dziekuje ci za wszystko co dla mnie robisz", "jestes wspaniala osoba i najlepsza dziewczyna jaka poznalem", "chce zebys pamietala ze nigdy nie jestes sama bo masz mnie", "jestem z toba zeby trzymac cie za raczke kiedy jest ci ciezko", "twoje serduszko jest cudowne a ja kocham kazda jego czesc nawet jak jest trudno", "niech twoj usmieszek bedzie swiatlem w naszym wspolnym zyciu", "kocham cie najmocniej na swiecie", "i mam jedno pytanie..."];
    let lineIdx = 0, charIdx = 0;
    function runTypewriter() {
        if (lineIdx < lines.length) {
            if (charIdx < lines[lineIdx].length) {
                typingArea.innerHTML += lines[lineIdx][charIdx];
                charIdx++; setTimeout(runTypewriter, 50);
            } else {
                setTimeout(() => { typingArea.innerHTML = ""; charIdx = 0; lineIdx++; runTypewriter(); }, 1500);
            }
        } else {
            typingArea.style.display = "none";
            canvas.style.filter = "blur(8px)";
            questionSection.style.display = "block";
        }
    }

    /* POPRAWIONE UCIEKANIE - PRZYCISK NIE */
    function moveNo() {
        // Obliczamy bezpieczny obszar (środek ekranu +/- 100px)
        // Dzięki temu przycisk nie ucieknie poza krawędzie Safari
        const padding = 50;
        const maxX = window.innerWidth - noBtn.offsetWidth - padding;
        const maxY = window.innerHeight - noBtn.offsetHeight - padding;
        
        const randomX = Math.max(padding, Math.floor(Math.random() * maxX));
        const randomY = Math.max(padding, Math.floor(Math.random() * maxY));

        noBtn.style.position = "fixed"; // Zmieniamy na fixed, żeby latał po całym ekranie
        noBtn.style.left = randomX + "px";
        noBtn.style.top = randomY + "px";
        noBtn.style.transform = "none"; // Usuwamy przesunięcie początkowe
    }

    function acceptValentine() {
        questionSection.style.display = "none";
        successSection.style.display = "block";
        music.play();
        for(let i=0; i<60; i++) {
            setTimeout(() => {
                const h = document.createElement("div");
                h.innerHTML = "❤️"; h.className = "heart";
                h.style.left = Math.random()*100 + "vw"; h.style.top = "100vh";
                document.body.appendChild(h);
                setTimeout(() => h.remove(), 3000);
            }, i * 80);
        }
    }
    
    window.addEventListener("resize", initStars);
</script>
</body>
</html>
